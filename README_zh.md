<center><h1>ğŸš€ RAGAnything: All-in-One RAG System</h1></center>

<div align="center">
<table border="0" width="100%">
<tr>
<td width="100" align="center">
<img src="./assets/logo.png" width="80" height="80" alt="raganything">
</td>
<td>

<div>
    <p>
        <a href='https://github.com/HKUDS/RAGAnything'><img src='https://img.shields.io/badge/é¡¹ç›®-ä¸»é¡µ-Green'></a>
        <a href='https://arxiv.org/abs/2410.05779'><img src='https://img.shields.io/badge/arXiv-2410.05779-b31b1b'></a>
        <a href='https://github.com/HKUDS/LightRAG'><img src='https://img.shields.io/badge/åŸºäº-LightRAG-blue'></a>
    </p>
    <p>
        <img src='https://img.shields.io/github/stars/HKUDS/RAGAnything?color=green&style=social' />
        <img src="https://img.shields.io/badge/python-3.9+-blue">
        <a href="https://pypi.org/project/raganything/"><img src="https://img.shields.io/pypi/v/raganything.svg"></a>
    </p>
    <p>
        <a href="README_zh.md">ä¸­æ–‡ç‰ˆ</a> | <a href="README.md">English</a>
    </p>
</div>
</td>
</tr>
</table>

<!-- åœ¨æ­¤å¤„æ·»åŠ æ¶æ„å›¾ -->
<!-- <img src="./assets/raganything_architecture.png" width="800" alt="RAGAnythingæ¶æ„å›¾"> -->

</div>

## ğŸŒŸ é¡¹ç›®æ¦‚è¿°

**RAGAnything** æ˜¯ä¸€ä¸ªåŸºäº [LightRAG](https://github.com/HKUDS/LightRAG) æ„å»ºçš„ç»¼åˆæ€§å¤šæ¨¡æ€æ–‡æ¡£å¤„ç†RAGï¼ˆæ£€ç´¢å¢å¼ºç”Ÿæˆï¼‰ç³»ç»Ÿã€‚å®ƒèƒ½å¤Ÿæ— ç¼å¤„ç†å’ŒæŸ¥è¯¢åŒ…å«æ–‡æœ¬ã€å›¾åƒã€è¡¨æ ¼ã€å…¬å¼å’Œå…¶ä»–å¤šæ¨¡æ€å†…å®¹çš„å¤æ‚æ–‡æ¡£ã€‚

### æ ¸å¿ƒç‰¹æ€§

- **ğŸ”„ ç«¯åˆ°ç«¯å¤šæ¨¡æ€å¤„ç†**ï¼šä»æ–‡æ¡£è§£æåˆ°å¤šæ¨¡æ€æŸ¥è¯¢å›ç­”çš„å®Œæ•´æµæ°´çº¿
- **ğŸ“„ å…¨é¢çš„æ–‡æ¡£æ”¯æŒ**ï¼šPDFã€Officeæ–‡æ¡£ï¼ˆDOC/DOCX/PPT/PPTXï¼‰ã€å›¾åƒç­‰å¤šç§æ ¼å¼
- **ğŸ§  é«˜çº§å†…å®¹åˆ†æ**ï¼šé’ˆå¯¹å›¾åƒã€è¡¨æ ¼ã€å…¬å¼å’Œé€šç”¨å†…å®¹çš„ä¸“ä¸šå¤„ç†å™¨
- **ğŸ”— çŸ¥è¯†å›¾è°±é›†æˆ**ï¼šè·¨æ¨¡æ€çš„è‡ªåŠ¨å®ä½“æå–å’Œå…³ç³»æ„å»º
- **âš¡ çµæ´»çš„å¤„ç†é€‰é¡¹**ï¼šåŸºäºMinerUçš„è§£ææˆ–ç›´æ¥å¤šæ¨¡æ€å†…å®¹æ’å…¥
- **ğŸ¯ æ™ºèƒ½æ£€ç´¢**ï¼šè·¨æ–‡æœ¬å’Œå¤šæ¨¡æ€å†…å®¹çš„æ··åˆæœç´¢

## ğŸ—ï¸ ç®—æ³•åŸç†ä¸æ¶æ„

### æ ¸å¿ƒç®—æ³•

RAGAnything å®ç°äº†ä¸€ä¸ª**å¤šé˜¶æ®µå¤šæ¨¡æ€å¤„ç†æµæ°´çº¿**ï¼Œå°†ä¼ ç»ŸRAGç³»ç»Ÿæ‰©å±•ä¸ºèƒ½å¤Ÿå¤„ç†å¤šæ ·åŒ–å†…å®¹ç±»å‹ï¼š

#### 1. æ–‡æ¡£è§£æé˜¶æ®µ
- **MinerUé›†æˆ**ï¼šåˆ©ç”¨ [MinerU](https://github.com/opendatalab/MinerU) è¿›è¡Œé«˜è´¨é‡æ–‡æ¡£ç»“æ„æå–
- **å†…å®¹åˆ†è§£**ï¼šè‡ªåŠ¨å°†æ–‡æ¡£åˆ†ç¦»ä¸ºæ–‡æœ¬å—ã€å›¾åƒã€è¡¨æ ¼ã€å…¬å¼å’Œå…¶ä»–å…ƒç´ 
- **æ ¼å¼æ”¯æŒ**ï¼šé€šè¿‡ä¸“ä¸šè§£æå™¨å¤„ç†PDFã€Officeæ–‡æ¡£ã€å›¾åƒç­‰å¤šç§æ ¼å¼

#### 2. å†…å®¹åˆ†ç¦»ä¸å¤„ç†
- **æ¨¡æ€åˆ†ç±»**ï¼šè‡ªåŠ¨è¯†åˆ«å’Œåˆ†ç±»ä¸åŒçš„å†…å®¹ç±»å‹
- **å¹¶è¡Œå¤„ç†**ï¼šé€šè¿‡ç‹¬ç«‹æµæ°´çº¿å¤„ç†æ–‡æœ¬å’Œå¤šæ¨¡æ€å†…å®¹
- **è´¨é‡ä¿æŒ**ï¼šç»´æŠ¤å†…å®¹å…ƒç´ ä¹‹é—´çš„åŸå§‹ç»“æ„å’Œå…³ç³»

#### 3. å¤šæ¨¡æ€åˆ†æå¼•æ“
ç³»ç»Ÿä¸ºä¸åŒæ¨¡æ€é‡‡ç”¨ä¸“ä¸šå¤„ç†å™¨ï¼š

- **ImageModalProcessorï¼ˆå›¾åƒæ¨¡æ€å¤„ç†å™¨ï¼‰**ï¼š
  - è§†è§‰æ¨¡å‹é›†æˆï¼Œè¿›è¡Œè¯¦ç»†å›¾åƒåˆ†æ
  - ä¸Šä¸‹æ–‡æ„ŸçŸ¥çš„æ ‡é¢˜ç”Ÿæˆ
  - è§†è§‰å…ƒç´ å…³ç³»æå–

- **TableModalProcessorï¼ˆè¡¨æ ¼æ¨¡æ€å¤„ç†å™¨ï¼‰**ï¼š
  - ç»“æ„åŒ–æ•°æ®è§£é‡Š
  - ç»Ÿè®¡æ¨¡å¼è¯†åˆ«
  - è·¨è¡¨æ ¼å…³ç³»è¯†åˆ«

- **EquationModalProcessorï¼ˆå…¬å¼æ¨¡æ€å¤„ç†å™¨ï¼‰**ï¼š
  - æ•°å­¦å…¬å¼è§£æ
  - LaTeXæ ¼å¼æ”¯æŒ
  - å…¬å¼-æ¦‚å¿µå…³ç³»æ˜ å°„

- **GenericModalProcessorï¼ˆé€šç”¨æ¨¡æ€å¤„ç†å™¨ï¼‰**ï¼š
  - è‡ªå®šä¹‰å†…å®¹ç±»å‹çš„çµæ´»å¤„ç†
  - æ–°æ¨¡æ€çš„å¯æ‰©å±•æ¡†æ¶

#### 4. çŸ¥è¯†å›¾è°±æ„å»º
- **å¤šæ¨¡æ€å®ä½“åˆ›å»º**ï¼šæ¯ä¸ªé‡è¦çš„å¤šæ¨¡æ€å…ƒç´ éƒ½æˆä¸ºçŸ¥è¯†å›¾è°±ä¸­çš„å®ä½“
- **è·¨æ¨¡æ€å…³ç³»**ï¼šåœ¨æ–‡æœ¬å®ä½“å’Œå¤šæ¨¡æ€å…ƒç´ ä¹‹é—´å»ºç«‹è¿æ¥
- **å±‚æ¬¡ç»“æ„**ï¼šé€šè¿‡"belongs_to"å…³ç³»ç»´æŠ¤æ–‡æ¡£ç»“æ„
- **åŠ æƒè¿æ¥**ï¼šä¸ºä¸åŒå…³ç³»ç±»å‹åˆ†é…ç›¸å…³æ€§åˆ†æ•°

#### 5. æ··åˆæ£€ç´¢ç³»ç»Ÿ
- **å‘é‡-å›¾è°±èåˆ**ï¼šç»“åˆå‘é‡ç›¸ä¼¼æ€§æœç´¢ä¸å›¾éå†
- **æ¨¡æ€æ„ŸçŸ¥æ’åº**ï¼šæ ¹æ®å†…å®¹ç±»å‹ç›¸å…³æ€§è°ƒæ•´æ£€ç´¢åˆ†æ•°
- **ä¸Šä¸‹æ–‡ä¿æŒ**ï¼šç»´æŠ¤æ£€ç´¢å…ƒç´ ä¹‹é—´çš„å…³ç³»


## ğŸš€ å¿«é€Ÿå¼€å§‹

### å®‰è£…

#### é€‰é¡¹1ï¼šä»PyPIå®‰è£…ï¼ˆæ¨èï¼‰
```bash
pip install raganything
```

#### é€‰é¡¹2ï¼šä»æºç å®‰è£…
```bash
git clone https://github.com/HKUDS/RAGAnything.git
cd RAGAnything
pip install -e .
```

#### MinerUä¾èµ–ï¼ˆå¯é€‰ï¼‰
ç”¨äºæ–‡æ¡£è§£æåŠŸèƒ½ï¼š
```bash
pip install "magic-pdf[full]>=1.2.2" huggingface_hub
```

ä¸‹è½½MinerUæ¨¡å‹ï¼š
```bash
# é€‰é¡¹1ï¼šHugging Face
wget https://github.com/opendatalab/MinerU/raw/master/scripts/download_models_hf.py
python download_models_hf.py

# é€‰é¡¹2ï¼šModelScopeï¼ˆé€‚ç”¨äºä¸­å›½ç”¨æˆ·ï¼‰
wget https://github.com/opendatalab/MinerU/raw/master/scripts/download_models.py
python download_models.py
```

### ä½¿ç”¨æ–¹æ³•

#### ç«¯åˆ°ç«¯æ–‡æ¡£å¤„ç†

```python
import asyncio
from raganything import RAGAnything
from lightrag.llm.openai import openai_complete_if_cache, openai_embed

async def main():
    # åˆå§‹åŒ–RAGAnything
    rag = RAGAnything(
        working_dir="./rag_storage",
        llm_model_func=lambda prompt, system_prompt=None, history_messages=[], **kwargs: openai_complete_if_cache(
            "gpt-4o-mini",
            prompt,
            system_prompt=system_prompt,
            history_messages=history_messages,
            api_key="your-api-key",
            **kwargs,
        ),
        vision_model_func=lambda prompt, system_prompt=None, history_messages=[], image_data=None, **kwargs: openai_complete_if_cache(
            "gpt-4o",
            "",
            system_prompt=None,
            history_messages=[],
            messages=[
                {"role": "system", "content": system_prompt} if system_prompt else None,
                {"role": "user", "content": [
                    {"type": "text", "text": prompt},
                    {
                        "type": "image_url",
                        "image_url": {"url": f"data:image/jpeg;base64,{image_data}"}
                    }
                ]} if image_data else {"role": "user", "content": prompt}
            ],
            api_key="your-api-key",
            **kwargs,
        ) if image_data else openai_complete_if_cache(
            "gpt-4o-mini",
            prompt,
            system_prompt=system_prompt,
            history_messages=history_messages,
            api_key="your-api-key",
            **kwargs,
        ),
        embedding_func=lambda texts: openai_embed(
            texts,
            model="text-embedding-3-large",
            api_key="your-api-key",
        ),
        embedding_dim=3072,
        max_token_size=8192
    )

    # å¤„ç†æ–‡æ¡£
    await rag.process_document_complete(
        file_path="path/to/your/document.pdf",
        output_dir="./output",
        parse_method="auto"
    )

    # æŸ¥è¯¢å¤„ç†åçš„å†…å®¹
    result = await rag.query_with_multimodal(
        "å›¾è¡¨ä¸­æ˜¾ç¤ºçš„ä¸»è¦å‘ç°æ˜¯ä»€ä¹ˆï¼Ÿ",
        mode="hybrid"
    )
    print(result)

if __name__ == "__main__":
    asyncio.run(main())
```

#### ç›´æ¥å¤šæ¨¡æ€å†…å®¹å¤„ç†

```python
import asyncio
from lightrag import LightRAG
from lightrag.modalprocessors import ImageModalProcessor, TableModalProcessor

async def process_multimodal_content():
    # åˆå§‹åŒ–LightRAG
    rag = LightRAG(
        working_dir="./rag_storage",
        # ... ä½ çš„LLMå’ŒåµŒå…¥é…ç½®
    )
    await rag.initialize_storages()

    # å¤„ç†å›¾åƒ
    image_processor = ImageModalProcessor(
        lightrag=rag,
        modal_caption_func=your_vision_model_func
    )

    image_content = {
        "img_path": "path/to/image.jpg",
        "img_caption": ["å›¾1ï¼šå®éªŒç»“æœ"],
        "img_footnote": ["æ•°æ®æ”¶é›†äº2024å¹´"]
    }

    description, entity_info = await image_processor.process_multimodal_content(
        modal_content=image_content,
        content_type="image",
        file_path="research_paper.pdf",
        entity_name="å®éªŒç»“æœå›¾è¡¨"
    )

    # å¤„ç†è¡¨æ ¼
    table_processor = TableModalProcessor(
        lightrag=rag,
        modal_caption_func=your_llm_model_func
    )

    table_content = {
        "table_body": """
        | æ–¹æ³• | å‡†ç¡®ç‡ | F1åˆ†æ•° |
        |------|--------|--------|
        | RAGAnything | 95.2% | 0.94 |
        | åŸºå‡†æ–¹æ³• | 87.3% | 0.85 |
        """,
        "table_caption": ["æ€§èƒ½å¯¹æ¯”"],
        "table_footnote": ["æµ‹è¯•æ•°æ®é›†ç»“æœ"]
    }

    description, entity_info = await table_processor.process_multimodal_content(
        modal_content=table_content,
        content_type="table",
        file_path="research_paper.pdf",
        entity_name="æ€§èƒ½ç»“æœè¡¨æ ¼"
    )

if __name__ == "__main__":
    asyncio.run(process_multimodal_content())
```

### æ‰¹é‡å¤„ç†

```python
# å¤„ç†å¤šä¸ªæ–‡æ¡£
await rag.process_folder_complete(
    folder_path="./documents",
    output_dir="./output",
    file_extensions=[".pdf", ".docx", ".pptx"],
    recursive=True,
    max_workers=4
)
```

### è‡ªå®šä¹‰æ¨¡æ€å¤„ç†å™¨

```python
from raganything.modalprocessors import GenericModalProcessor

class CustomModalProcessor(GenericModalProcessor):
    async def process_multimodal_content(self, modal_content, content_type, file_path, entity_name):
        # ä½ çš„è‡ªå®šä¹‰å¤„ç†é€»è¾‘
        enhanced_description = await self.analyze_custom_content(modal_content)
        entity_info = self.create_custom_entity(enhanced_description, entity_name)
        return await self._create_entity_and_chunk(enhanced_description, entity_info, file_path)
```

### æŸ¥è¯¢é€‰é¡¹

```python
# ä¸åŒçš„æŸ¥è¯¢æ¨¡å¼
result_hybrid = await rag.query_with_multimodal("ä½ çš„é—®é¢˜", mode="hybrid")
result_local = await rag.query_with_multimodal("ä½ çš„é—®é¢˜", mode="local")
result_global = await rag.query_with_multimodal("ä½ çš„é—®é¢˜", mode="global")
```

## ğŸ› ï¸ ç¤ºä¾‹

`examples/` ç›®å½•åŒ…å«å®Œæ•´çš„ä½¿ç”¨ç¤ºä¾‹ï¼š

- **`raganything_example.py`**ï¼šåŸºäºMinerUçš„ç«¯åˆ°ç«¯æ–‡æ¡£å¤„ç†
- **`modalprocessors_example.py`**ï¼šç›´æ¥å¤šæ¨¡æ€å†…å®¹å¤„ç†

è¿è¡Œç¤ºä¾‹ï¼š
```bash
# ç«¯åˆ°ç«¯å¤„ç†
python examples/raganything_example.py path/to/document.pdf --api-key YOUR_API_KEY

# ç›´æ¥æ¨¡æ€å¤„ç†
python examples/modalprocessors_example.py --api-key YOUR_API_KEY
```

## ğŸ”§ é…ç½®

### ç¯å¢ƒå˜é‡

åˆ›å»º `.env` æ–‡ä»¶ï¼ˆå‚è€ƒ `.env.example`ï¼‰ï¼š
```bash
OPENAI_API_KEY=your_openai_api_key
OPENAI_BASE_URL=your_base_url  # å¯é€‰
```

### MinerUé…ç½®

ç³»ç»Ÿè‡ªåŠ¨ä½¿ç”¨ç”¨æˆ·ç›®å½•ä¸‹çš„MinerUé…ç½®æ–‡ä»¶ `magic-pdf.json`ã€‚ä½ å¯ä»¥è‡ªå®šä¹‰ï¼š
- æ¨¡å‹ç›®å½•è·¯å¾„
- OCRå¼•æ“è®¾ç½®
- GPUåŠ é€Ÿé€‰é¡¹
- ç¼“å­˜è®¾ç½®

## ğŸ§ª æ”¯æŒçš„å†…å®¹ç±»å‹

### æ–‡æ¡£æ ¼å¼
- **PDF**ï¼šç ”ç©¶è®ºæ–‡ã€æŠ¥å‘Šã€æ¼”ç¤ºæ–‡ç¨¿
- **Officeæ–‡æ¡£**ï¼šDOCã€DOCXã€PPTã€PPTX
- **å›¾åƒ**ï¼šJPGã€PNGã€BMPã€TIFF
- **æ–‡æœ¬æ–‡ä»¶**ï¼šTXTã€MD

### å¤šæ¨¡æ€å…ƒç´ 
- **å›¾åƒ**ï¼šç…§ç‰‡ã€å›¾è¡¨ã€ç¤ºæ„å›¾ã€æˆªå›¾
- **è¡¨æ ¼**ï¼šæ•°æ®è¡¨ã€å¯¹æ¯”å›¾ã€ç»Ÿè®¡æ‘˜è¦
- **å…¬å¼**ï¼šLaTeXæ ¼å¼çš„æ•°å­¦å…¬å¼
- **é€šç”¨å†…å®¹**ï¼šé€šè¿‡å¯æ‰©å±•å¤„ç†å™¨æ”¯æŒçš„è‡ªå®šä¹‰å†…å®¹ç±»å‹

## ğŸ“– å¼•ç”¨

å¦‚æœä½ åœ¨ç ”ç©¶ä¸­å‘ç°RAGAnythingæœ‰ç”¨ï¼Œè¯·å¼•ç”¨æˆ‘ä»¬çš„è®ºæ–‡ï¼š

```bibtex
@article{guo2024lightrag,
  title={LightRAG: Simple and Fast Retrieval-Augmented Generation},
  author={Zirui Guo and Lianghao Xia and Yanhua Yu and Tu Ao and Chao Huang},
  year={2024},
  eprint={2410.05779},
  archivePrefix={arXiv},
  primaryClass={cs.IR}
}
```

## ğŸ”— ç›¸å…³é¡¹ç›®

- [LightRAG](https://github.com/HKUDS/LightRAG)ï¼šåŸºç¡€RAGç³»ç»Ÿ
- [VideoRAG](https://github.com/HKUDS/VideoRAG)ï¼šè§†é¢‘ç†è§£RAGç³»ç»Ÿ
- [MiniRAG](https://github.com/HKUDS/MiniRAG)ï¼šåŸºäºå°æ¨¡å‹çš„è½»é‡çº§RAG

## Star History

<!-- <a href="https://star-history.com/#HKUDS/RAGAnything&Date">
 <picture>
   <source media="(prefers-color-scheme: dark)" srcset="https://api.star-history.com/svg?repos=HKUDS/RAGAnything&type=Date&theme=dark" />
   <source media="(prefers-color-scheme: light)" srcset="https://api.star-history.com/svg?repos=HKUDS/RAGAnything&type=Date" />
   <img alt="Star History Chart" src="https://api.star-history.com/svg?repos=HKUDS/RAGAnything&type=Date" />
 </picture>
</a> -->

## è´¡çŒ®è€…

æ„Ÿè°¢æ‰€æœ‰è´¡çŒ®è€…ï¼

<!-- <a href="https://github.com/HKUDS/RAGAnything/graphs/contributors">
  <img src="https://contrib.rocks/image?repo=HKUDS/RAGAnything" />
</a> -->

---

<div align="center">
    <p>
        <a href="https://github.com/HKUDS/RAGAnything">â­ åœ¨GitHubä¸Šä¸ºæˆ‘ä»¬ç‚¹æ˜Ÿ</a> |
        <a href="https://github.com/HKUDS/RAGAnything/issues">ğŸ› æŠ¥å‘Šé—®é¢˜</a> |
        <a href="https://github.com/HKUDS/RAGAnything/discussions">ğŸ’¬ è®¨è®ºäº¤æµ</a>
    </p>
</div>
